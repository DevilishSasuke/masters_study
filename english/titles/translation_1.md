YOLOv6: одноступенчатая структура обнаружения объектов для промышленных приложений

# Abstract

На протяжении многих лет серия YOLO была стандартом на промышленном уровне для эффективного обнаружения объектов. Сообщество YOLO процветало, обогащая свое использование в множестве платформ ПО и разных сценариях. В этом техническом отчете мы стремимся вывести его возможности на новый уровень, шагая вперед с непоколебимым мышлением для применения в промышленности. Учитывая разнообразные требования к скорости и точности в реальной среде, мы тщательно изучаем последние достижения в области обнаружения объектов, как в промышленности, так и в академической среде. В частности, мы активно используем идеи из последних разработок в области проектирования сетей, стратегий обучения, методов тестирования, квантования и оптимизации. Вдобавок к этому, мы объединяем наши идеи и практику, чтобы создать набор сетей, готовых к развертыванию в различных масштабах, для удовлетворения разнообразных вариантов использования. С любезного разрешения авторов YOLO мы назвали его YOLOv6. Мы также выражаем нашу теплую благодарность пользователям и участникам за дальнейшее совершенствование. Для обзора производительности - наша YOLOv6-N достигает 35,9% AP (средняя точность) на наборе данных COCO при пропускной способности 1234 FPS на графическом процессоре NVIDIA Tesla T4. YOLOv6-S достигает 43,5% AP при 495 FPS, превосходя другие популярные детекторы того же масштаба (YOLOv5-S, YOLOX-S и PPYOLOE-S). Наша квантованная версия YOLOv6-S даже достигает нового рекордного показателя 43,3% AP при 869 FPS. Кроме того, YOLOv6-M/L также достигает более высокую точность (49,5%/52,3%) по сравнению с другими детекторами с аналогичной скоростью вывода. Мы тщательно провели эксперименты, чтобы подтвердить эффективность каждого компонента. Наш код доступен по адресу https://github.com/meituan/YOLOv6

# Introduction

Серия YOLO является наиболее популярным фреймворком для обнаружения в промышленных приложениях благодаря отличному балансу между скоростью и точностью. Пионерскими работами серии YOLO являются YOLOv1-3, которые открыли новый путь для одноэтапных детекторов, а также последующие существенные усовершенствования. YOLOv4 реорганизовал фреймворк обнаружения на несколько отдельных частей (основа, шея и голова) и проверил bag-of-freebies (увеличение вычислительной стоимости) и bag-of-specials (увеличение стоимости обучения),чтобы разработать систему, подходящую для обучения на одном GPU. В настоящее время YOLOv5 , YOLOX , PPY-OLOE и YOLOv7 являются конкурентами в сфере эффективных детекторов для развертывания. Модели разных размеров обычно получают с помощью методов масштабирования. 

В этом отчете мы эмпирически наблюдали несколько важных факторов, которые смотивировали нас переработать структуру YOLO: 

* Репараметризация из RepVGG это превосходная техника, которая еще не нашла широкого применения в обнаружении. Мы также заметили, что простое масштабирование модели для блоков RepVGG становится непрактичным, поскольку мы считаем, что элегантная согласованность дизайна сети между маленькими и большими сетями не является необходимой. Простая архитектура одноого пути является лучшим выбором для маленьких сетей, но для более крупных моделей экспоненциальный рост параметров и вычислительных затрат архитектуры одного пути делает ее непригодной;

* Квантование детекторов на основе репараметризации также требует тщательного подхода, в противном случае будет невозможно справиться с ухудшением производительности из-за гетерогенной конфигурации во время обучения и вывода;

* В предыдущих работах обычно уделяется меньше внимания развертыванию, задержки которого обычно сравниваются на дорогостоящих машинах, таких как V100. Существует разрыв в аппаратном обеспечении, когда речь заходит о реальной среде обслуживания. Как правило, низкомощные графические процессоры, такие как Tesla T4, менее затратны и обеспечивают довольно хорошую производительность вывода;

* Передовые стратегии для конкретных областей, такие как присвоение меток и проектирование функции потерь, требуют дальнейшей проверки с учетом архитектурных различий;

* Для развертывания мы можем допустить исправления стратегии обучения, которые улучшают точность вычислений, но не увеличивают затраты на вывод, такие как дистилляция знаний.

С учетом вышеупомянутых наблюдений мы представляем YOLOv6, который на данный момент обеспечивает наилучший компромисс между точностью и скоростью. На рисунке 1 показано сравнение YOLOv6 с другими аналогами такого же масштаба. Чтобы повысить скорость вывода без значительного снижения производительности, мы изучили передовые методы квантования, включая квантование после обучения (PTQ) и обучение с учетом квантования (QAT), и внедрили их в YOLOv6, чтобы достичь цели сетей, готовых к развертыванию. Мы обобщаем основные аспекты YOLOv6 следующим образом:

* Мы переработали ряд сетей разных размеров, предназначенных для промышленного применения в различных сценариях. Архитектуры разных масштабов варьируются для достижения оптимального соотношения скорости и точности, где небольшие модели имеют простую основу одного пути, а большие модели построены на эффективных блоках с несколькими ветвями.

* Мы наделили YOLOv6 стратегией самодистилляции, выполняемой как для задачи классификации, так и для задачи регрессии. В то же время мы динамически корректируем знания от учителя и метки, чтобы помочь ученику-модели более эффективно усваивать знания на всех этапах обучения.

* Мы широко проверяем улучшенные методы обнаружения для присвоения меток, функции потерь и методы аугментации данных и выборочно применяем их для дальнейшего повышения производительности.

* Мы переделываем схему квантования для обнаружения с помощью RepOptimizer  и дистилляции по каналам, что приводит к еще более быстрому и точному детектору с 43,3% COCO точностью и пропускной способностью 869 FPS при размере партии 32.

# Пересказ

## Кратко

YOLOv6 — модель для промышленного распознавания объектов.  

Она сочетает современные подходы в архитектуре, обучении и квантовании.  

Модель показывает высокую точность и скорость в реальном времени и готова к внедрению.

## Введение

Серия YOLO популярна за баланс точности и скорости.  

Есть проблемы с масштабированием, квантованием и дешёвым железом. 

YOLOv6 решает их за счёт новой архитектуры, самодистилляции и улучшенных методов обучения

## Методы

YOLOv6 - это одноступенчатый детектор объектов, т.е. вся система распознавания работает за один проход (классификация и нахождение областей). Обычно такие детекторы состоят из следующих частей: позвоночник, шея и голова.

Позвоночник обычно определяет способность представления признаков, он влияет на эффективность вывода. 

Шея служит для агрегирования низкоуровневых признаков и построения карт признаков.

Голова прогнозирует окончательный результат распознавания.

Таким образом, для позвоночника этой модели была разработана основа под названием EfficientRep, которая учитывает как небольшие, так и емкие модели, т.к. учтена экспоненциональная затрата при росте модели. Это позволяет достичь баланса точности и скорости. 

Шеей был выбран механизм Rep-PAN, который является улучшенной версией основы PAN с замененным блоком.

Для головы используются безъякорные детекторы за счет лучшей способности к обобщению и простоте декодирования результатов прогнозирования. Существует два типа детекторов: на основе точек привязки и на основе ключевых точек. В данной модели используются точки привязки, которые предсказывают расстояние от точки до рамок объекта.

## Результаты

По результатам сравнения с другими актуальными детекторами, эта модель превосходит их как по точности, так и по скорости. Также были предоставлены различные методы кватнования PTQ и QAT.

# Перевод пересказа

# Abstract

YOLOv6 is a model for industrial object recognition.

It combines modern approaches to architecture, training, and quantization.

The model demonstrates high accuracy and real-time speed and is ready for implementation.

## Introduction

The YOLO series is popular for its balance of accuracy and speed.

There are problems with scaling, quantization, and cheap hardware.

YOLOv6 solves them with a new architecture, self-distillation, and improved training methods.

## Methods

YOLOv6 is a single-stage object detector, i.e., the entire recognition system works in a single pass (classification and region detection). Typically, such detectors consist of the following parts: backbone, neck, and head.

The backbone usually determines the ability to represent features and affects the efficiency of inference.

The neck serves to aggregate low-level features and build feature maps.

The head predicts the final recognition result.

Thus, a base called EfficientRep was developed for the backbone of this model, which takes into account both small and large models, as it considers the exponential cost of model growth. This allows for a balance between accuracy and speed.

The Rep-PAN mechanism was chosen for the neck, which is an improved version of the PAN base with a replaced block.

Anchorless detectors are used for the head due to their better generalization ability and ease of decoding prediction results. There are two types of detectors: anchor-based and keypoint-based. This model uses anchor points that predict the distance from a point to the object's boundaries.

## Results

Based on comparisons with other current detectors, this model outperforms them in both accuracy and speed. Various PTQ and QAT quantization methods were also provided
